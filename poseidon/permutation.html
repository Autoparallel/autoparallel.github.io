<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Permutation - Poseidon Journal</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../overview/index.html"><strong aria-hidden="true">1.</strong> Overview</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../overview/curriculum.html"><strong aria-hidden="true">1.1.</strong> Curriculum</a></li><li class="chapter-item expanded "><a href="../overview/motivation.html"><strong aria-hidden="true">1.2.</strong> motivation</a></li></ol></li><li class="chapter-item expanded "><a href="../poseidon/index.html"><strong aria-hidden="true">2.</strong> Poseidon</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../poseidon/construction.html"><strong aria-hidden="true">2.1.</strong> Construction</a></li><li class="chapter-item expanded "><a href="../poseidon/scalar_field.html"><strong aria-hidden="true">2.2.</strong> Scalar Field</a></li><li class="chapter-item expanded "><a href="../poseidon/sponge.html"><strong aria-hidden="true">2.3.</strong> Sponge</a></li><li class="chapter-item expanded "><a href="../poseidon/permutation.html" class="active"><strong aria-hidden="true">2.4.</strong> Permutation</a></li><li class="chapter-item expanded "><a href="../poseidon/s-boxes.html"><strong aria-hidden="true">2.5.</strong> S-Boxes</a></li><li class="chapter-item expanded "><a href="../poseidon/linear_layer.html"><strong aria-hidden="true">2.6.</strong> Linear Layer</a></li><li class="chapter-item expanded "><a href="../poseidon/round_constants.html"><strong aria-hidden="true">2.7.</strong> Round Constants</a></li></ol></li><li class="chapter-item expanded "><a href="../security/index.html"><strong aria-hidden="true">3.</strong> Security</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../security/linear_cryptanalysis.html"><strong aria-hidden="true">3.1.</strong> Linear Cryptanalysis</a></li><li class="chapter-item expanded "><a href="../security/differential_cryptanalysis.html"><strong aria-hidden="true">3.2.</strong> Differential Cryptanalysis</a></li><li class="chapter-item expanded "><a href="../security/algebraic_cryptanalysis.html"><strong aria-hidden="true">3.3.</strong> Algebraic Cryptanalysis</a></li><li class="chapter-item expanded "><a href="../security/new_thoughts.html"><strong aria-hidden="true">3.4.</strong> New Ideas for attacks</a></li></ol></li><li class="chapter-item expanded "><a href="../resources/index.html"><strong aria-hidden="true">4.</strong> Resources</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../resources/blogs_and_code.html"><strong aria-hidden="true">4.1.</strong> Blogs and Code</a></li><li class="chapter-item expanded "><a href="../resources/videos_talks.html"><strong aria-hidden="true">4.2.</strong> Videos and talks</a></li><li class="chapter-item expanded "><a href="../resources/people_courses.html"><strong aria-hidden="true">4.3.</strong> People and courses</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Poseidon Journal</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<h1 id="permutation"><a class="header" href="#permutation">Permutation</a></h1>
<p>We've seen that Poseidon uses a sponge construction to hash data, but the sponge alone is not enough to ensure security.
This is a common theme in cryptography: we often need to add additional layers of complexity to ensure that our constructions are secure.
Where one layer has a weakness, another layer can make up for it.
The permutation is one such layer that Poseidon uses to ensure security.</p>
<h2 id="permutation-is-like-a-blender"><a class="header" href="#permutation-is-like-a-blender">Permutation is like a blender</a></h2>
<p>Imagine the Poseidon permutation as a process similar to using a kitchen blender to mix ingredients together.
We can think of this in the context of the sponge construction, where the permutation is applied to the sponge's state to mix the input data with the existing state.</p>
<ol>
<li>
<p><strong>Initial Setup (State Initialization):</strong></p>
<ul>
<li>Think of foods and liquids inside of the blender's jar as a represention of the internal state of the hash function. 
When it's not blended, the ingredients are still separate and distinct, but once blended, they become a single mixture and are no longer distinguishable.
The unblended mixture corresponds to the initial state in the Poseidon hash function.</li>
<li><strong>Blender Jar (Sponge Capacity):</strong>
<ul>
<li>This blender jar  effectively represents the internal state of the sponge, which is called its &quot;capacity.&quot; This capacity includes both the part of the state that interacts with the input (like absorbing ingredients) and the part that does not.</li>
<li>In cryptographic terms, the capacity is crucial for security. It's like having a larger jar that ensures even after adding and mixing ingredients, there's still space left that never directly interacts with the ingredients you add later. This 'unused space' in the jar is what guarantees the security of the hash function.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Adding Ingredients (Input Absorption):</strong></p>
<ul>
<li>Each piece of data to be hashed is akin to adding another ingredient to the blender's jar. 
In Poseidon, this involves integrating the input data into the internal state.</li>
<li><strong>Amount of Food (Sponge Rate):</strong>
<ul>
<li>The amount of food you can add at once to the blender is like the &quot;rate&quot; of the sponge. It's the portion of the sponge's capacity that directly interacts with the input data (or ingredients).</li>
<li>In the sponge construction, you can only absorb (or add) a certain amount of data in each round, just like you can only add a certain amount of food to the blender at once without overfilling it.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Blending Process (Permutation Rounds):</strong></p>
<ul>
<li>The heart of the POSEIDON permutation is akin to the blending process. Here, the blender goes through several rounds of blending, each round mixing the ingredients thoroughly.</li>
<li>In POSEIDON, each round consists of a series of mathematical operations (like stirring, chopping, or grinding in a blender). These operations include:
<ul>
<li><strong>Linear Mixing:</strong> Similar to a gentle stir or a slow blend, ensuring that all parts of the mixture are evenly combined.</li>
<li><strong>Non-linear Transformation (S-Boxes):</strong> This is like a high-speed blend or pulse, creating complex interactions among the ingredients. It's where the non-linear S-boxes come into play, introducing complexity and security.</li>
<li><strong>Fixed Permutation Pattern:</strong> Just like following a specific sequence in blending (like pulse, blend, stir), POSEIDON follows a fixed pattern of mixing and transforming in each round.</li>
</ul>
</li>
<li><strong>Blending/Pulsing (Permutation):</strong>
<ul>
<li>Once you've added food to the blender (absorbed data into the rate part of the sponge), you start the blending or pulsing. This is analogous to applying the permutation in the sponge construction. This step thoroughly mixes the contents (data) with the existing state.</li>
<li>The permutation (blending) ensures that the data is uniformly and complexly mixed, contributing to the hash function's security.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Repeating the Rounds:</strong></p>
<ul>
<li>Just as some recipes call for you to &quot;blend until smooth&quot;, POSEIDON repeats its blending (permutation) rounds a set number of times to ensure thorough mixing and security.</li>
</ul>
</li>
<li>
<p><strong>Final Product (Hash Output):</strong></p>
<ul>
<li>After the final round of blending, the mixture in the blender represents the transformed state. In the context of the full sponge construction, part of this state is then 'squeezed out' to produce the hash output.</li>
<li><strong>Satisfaction and Emptying (Squeezing):</strong>
<ul>
<li>When you're satisfied with the blending (after sufficient permutations), you pour out the mix from the blender. In the sponge construction, this is akin to the squeezing phase, where part of the state (the equivalent of the mix you pour out) is read out as the hash result.</li>
<li>If your desired hash output is larger than what you can pour out in one go, you would blend again (apply another permutation) and pour out more, just like making multiple servings from a blender by blending and pouring in stages.</li>
</ul>
</li>
</ul>
</li>
</ol>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../poseidon/sponge.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../poseidon/s-boxes.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../poseidon/sponge.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../poseidon/s-boxes.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
